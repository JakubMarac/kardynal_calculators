<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kalkulator – Najkorzystniejsza forma opodatkowania (2026, 1:1 jak inFakt)</title>

  <style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');

  #kalkulator-b2b-wrapper {
      font-family: 'Inter', sans-serif;
      font-size: 14px;
      font-weight: 400;
      color: #333;
      background: #fff;
      padding: 20px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      max-width: 800px;
      margin: 0 auto;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
  }

  .calc-form-group {
      margin-bottom: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      align-items: flex-end;
  }

  .calc-input-wrapper { flex: 1; min-width: 200px; }

  .calc-input-wrapper.zus-wrapper {
      flex-basis: 100%;
      display: flex;
      align-items: center;
      gap: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
      margin-bottom: 10px;
  }

  .calc-input-wrapper label.main-label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      font-size: 14px;
      color: #333;
  }

  .calc-input-wrapper input[type="number"],
  .calc-input-wrapper select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-family: 'Inter', sans-serif;
      font-size: 14px;
      box-sizing: border-box;
  }

  .zus-label-question {
      font-weight: 400;
      font-size: 15px;
      color: #555;
      margin-right: 10px;
      min-width: 140px;
  }

  .zus-radio-group { display: flex; gap: 20px; align-items: center; flex-wrap: wrap; }

  .radio-option { display: flex; align-items: center; cursor: pointer; font-size: 14px; }

  .radio-option input[type="radio"] {
      appearance: none;
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border: 1px solid #ccc;
      border-radius: 50%;
      margin-right: 8px;
      position: relative;
      cursor: pointer;
      background-color: #fff;
  }

  .radio-option input[type="radio"]:checked { border-color: #1d405e; }
  .radio-option input[type="radio"]:checked::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 10px;
      height: 10px;
      background-color: #1d405e;
      border-radius: 50%;
  }

  .consultation-wrapper { margin-top: 20px; width: 100%; }
  .consult-btn {
      display: block;
      width: 100%;
      box-sizing: border-box;
      padding: 15px 20px;
      background-color: #000000 !important;
      color: #ffffff !important;
      border: 1px solid #000000 !important;
      text-align: center;
      text-decoration: none !important;
      border-radius: 0 !important;
      font-weight: 600;
      font-size: 16px;
      transition: all 0.3s ease !important;
      outline: none !important;
  }
  .consult-btn:hover {
      background-color: #ffffff !important;
      color: #000000 !important;
      border: 1px solid #000000 !important;
      cursor: pointer;
  }

  @media (max-width: 650px) {
      .calc-input-wrapper.zus-wrapper { flex-direction: column; align-items: flex-start; gap: 10px; }
  }

  /* Benchmark-like header + sliders + results card */
  .calc-title-top{
    font-size: 13px; letter-spacing: .08em; text-transform: uppercase;
    color:#777; margin: 4px 0 6px;
  }
  .calc-h1{
    font-size: 44px; line-height: 1.05;
    margin: 0 0 18px; font-weight: 600; color:#1d1d1d;
  }
  .calc-divider{ height:1px; background:#e9e9e9; margin: 10px 0 18px; }

  .calc-slider-row{
    display:flex; gap:16px; align-items:center; flex-wrap:wrap; margin-top: 6px;
  }
  .calc-slider-inline{ flex: 1; min-width: 260px; }
  input[type="range"]{ width:100%; accent-color:#1d78d6; }
  .calc-range-meta{
    display:flex; justify-content:space-between;
    color:#777; margin-top: 6px; font-size: 12px;
  }

  .calc-rycz-ticks{
    display:flex; justify-content:space-between;
    color:#777; font-size:12px; margin-top: 8px; gap: 8px;
  }
  .calc-rycz-ticks span{ min-width: 24px; text-align:center; }

  .results-card{
    background:#fff;
    border: 1px solid #e6e6e6;
    border-radius: 14px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.10);
    padding: 18px;
    margin-top: 16px;
  }
  .results-card h3{
    margin: 0 0 14px;
    font-size: 22px;
    font-weight: 600;
    color:#1d1d1d;
  }
  .results-line{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding: 16px 0;
    border-top: 1px solid #eee;
    font-size: 20px;
  }
  .results-line:first-of-type{ border-top: 0; }
  .results-label{ display:flex; gap:10px; align-items:center; }
  .info-dot{
    display:inline-flex;
    width: 18px; height: 18px;
    border-radius: 50%;
    background:#c9c9c9;
    color:#fff;
    align-items:center;
    justify-content:center;
    font-size: 12px;
    font-weight: 600;
    line-height: 1;
  }
  .results-value{ font-weight: 600; }
  .best-badge{
    display:inline-block;
    margin-left: 10px;
    font-size: 12px;
    padding: 3px 8px;
    border-radius: 999px;
    background:#e7f1ff;
    color:#1d78d6;
    border:1px solid #cfe3ff;
    font-weight:600;
  }
  .primary-cta{
    margin-top: 16px;
    display:block;
    width:100%;
    padding: 16px 18px;
    border-radius: 10px;
    border: 0;
    background: linear-gradient(180deg, #1d78d6, #1663b5);
    color:#fff;
    font-weight: 600;
    font-size: 18px;
    text-align:center;
    text-decoration:none;
  }

  .calc-note{
    font-size: 11px;
    color: #777;
    margin-top: 10px;
    line-height: 1.4;
  }
  </style>
</head>

<body>
  <div id="kalkulator-b2b-wrapper">

    <div class="calc-title-top">KALKULATOR DZIAŁALNOŚCI GOSPODARCZEJ</div>
    <div class="calc-h1">Najkorzystniejsza forma<br/>opodatkowania</div>
    <div class="calc-divider"></div>

    <div class="calc-form-group">

      <!-- Przychód -->
      <div class="calc-input-wrapper" style="flex-basis:100%;">
        <label class="main-label" for="incomeAmount">Twój miesięczny przychód netto</label>
        <div class="calc-slider-row">
          <div style="width:160px; min-width:160px;">
            <input type="number" id="incomeAmount" min="0" step="100" value="10000" />
          </div>
          <div style="margin-right:10px; color:#777;">zł</div>
          <div class="calc-slider-inline">
            <input type="range" id="incomeRange" min="100" max="100000" step="100" value="10000" />
            <div class="calc-range-meta">
              <span>100 zł</span>
              <span>100 000 zł</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Koszty -->
      <div class="calc-input-wrapper" style="flex-basis:100%;">
        <label class="main-label" for="costAmount">Twoje miesięczne koszty netto</label>
        <div class="calc-slider-row">
          <div style="width:160px; min-width:160px;">
            <input type="number" id="costAmount" min="0" step="50" value="500" />
          </div>
          <div style="margin-right:10px; color:#777;">zł</div>
          <div class="calc-slider-inline">
            <input type="range" id="costRange" min="0" max="20000" step="50" value="500" />
            <div class="calc-range-meta">
              <span>0 zł</span>
              <span>20 000 zł</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Ryczałt -->
      <div class="calc-input-wrapper" style="flex-basis:100%;">
        <label class="main-label" for="ryczRateDisplay">Stawka ryczałtu <span class="info-dot" title="Dobierz wg PKWiU">i</span></label>
        <div class="calc-slider-row">
          <div style="width:160px; min-width:160px;">
            <div style="display:flex; gap:10px; align-items:center;">
              <input type="number" id="ryczRateDisplay" min="0" step="0.1" value="12" />
              <span style="color:#777;">%</span>
            </div>
          </div>
          <div class="calc-slider-inline">
            <input type="range" id="ryczRateIndex" min="0" max="8" step="1" value="4" />
            <div class="calc-rycz-ticks" aria-hidden="true">
              <span>2%</span><span>3%</span><span>5.5%</span><span>8.5%</span><span>12%</span><span>12.5%</span><span>14%</span><span>15%</span><span>17%</span>
            </div>
          </div>
        </div>
      </div>

      <!-- ZUS -->
      <div class="calc-input-wrapper zus-wrapper">
        <span class="zus-label-question">Jaki ZUS opłacasz?</span>
        <div class="zus-radio-group">
          <!-- data-lumpsum: odpowiednik "zus_lumpsum" z inFakt (domyślnie ustawione jak value) -->
          <label class="radio-option">
            <input type="radio" name="zusOption" value="1926.76" data-lumpsum="1788.29" checked>
            Duży ZUS
          </label>
          <label class="radio-option">
            <input type="radio" name="zusOption" value="456.18" data-lumpsum="456.18">
            Mały ZUS
          </label>
          <label class="radio-option">
            <input type="radio" name="zusOption" value="0" data-lumpsum="0">
            Tylko zdrowotna (bez społecznych)
          </label>
        </div>
      </div>

      <div class="calc-input-wrapper" style="flex-basis:100%;">
        <div class="calc-note">
          Składka zdrowotna jest liczona automatycznie (rocznie, a wynik prezentowany jako średnia miesięczna),
          zgodnie z algorytmem benchmarku.
        </div>
      </div>

    </div>

    <!-- Wyniki -->
    <div class="results-card" id="resultsCard">
      <h3>Twój miesięczny dochód netto</h3>

      <div class="results-line" id="lineScale">
        <div class="results-label">
          Skala podatkowa <span class="info-dot" title="Model roczny/12 (jak benchmark)">i</span>
        </div>
        <div class="results-value" id="netScale">0 zł</div>
      </div>

      <div class="results-line" id="lineLinear">
        <div class="results-label">
          Podatek liniowy <span class="info-dot" title="Uwzględnia limit odliczenia zdrowotnej (jak benchmark)">i</span>
        </div>
        <div class="results-value" id="netLinear">0 zł</div>
      </div>

      <div class="results-line" id="lineRycz">
        <div class="results-label">
          Ryczałt <span class="info-dot" title="Podstawa: przychód roczny minus 50% zdrowotnej minus zus_lumpsum (jak benchmark)">i</span>
        </div>
        <div class="results-value" id="netRycz">0 zł</div>
      </div>

      <a class="primary-cta" href="#kontakt">Przejdź na B2B</a>

      <div class="calc-note" style="margin-top:12px;">
        Uwaga: wynik jest średnią miesięczną z rozliczenia rocznego (model porównawczy).
      </div>
    </div>

    <div class="consultation-wrapper">
      <a href="https://kka-przeksztalca.pl/#kontakt" class="consult-btn">Darmowa konsultacja</a>
    </div>

  </div>

<script>
/* ====== Dane (2026) – wg contributionsData które wkleiłeś wcześniej ====== */
window.contributionsData = window.contributionsData || {
  "2026": {
    "zus_small": 456.18,
    "zus_large": 1926.76,
    "health_contribution_general": 432.54,
    "health_contribution_linear": 432.54,
    "health_contribution_lumpsum_60": 498.35,
    "health_contribution_lumpsum_300": 830.58,
    "health_contribution_lumpsum_over_300": 1495.04,
    "health_contribution_min_linear": 8827.35,
    "salary_min": 4806,
    "limit_health_contribution": 14100
  }
};

document.addEventListener("DOMContentLoaded", () => {
  const YEAR = "2026";
  const C = window.contributionsData?.[YEAR];
  if (!C) return;

  // DOM
  const incomeAmount = document.getElementById("incomeAmount");
  const incomeRange  = document.getElementById("incomeRange");

  const costAmount = document.getElementById("costAmount");
  const costRange  = document.getElementById("costRange");

  const ryczRateDisplay = document.getElementById("ryczRateDisplay");
  const ryczRateIndex   = document.getElementById("ryczRateIndex");

  const netScaleEl  = document.getElementById("netScale");
  const netLinearEl = document.getElementById("netLinear");
  const netRyczEl   = document.getElementById("netRycz");

  const lineScale  = document.getElementById("lineScale");
  const lineLinear = document.getElementById("lineLinear");
  const lineRycz   = document.getElementById("lineRycz");

  const RYCZ_RATES = [2, 3, 5.5, 8.5, 12, 12.5, 14, 15, 17];

  // Helpers
  const n = (v) => {
    const x = Number(v);
    return Number.isFinite(x) ? x : 0;
  };

  const fmtPLN = (v) =>
    (Number.isFinite(v) ? v : 0).toLocaleString("pl-PL", {
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    }) + " zł";

  const round2 = (v) => Math.round((Number(v) || 0) * 100) / 100;

  function getZusMonthlyAndLumpMonthly(){
    const checked = document.querySelector('input[name="zusOption"]:checked');
    if (!checked) return { zusM: 0, zusLumpM: 0 };
    const zusM = n(checked.value);
    const zusLumpM = n(checked.getAttribute("data-lumpsum"));
    return { zusM, zusLumpM };
  }

  function setBestHighlight(nets){
    if (!lineScale || !lineLinear || !lineRycz) return;

    [lineScale, lineLinear, lineRycz].forEach(el => el.style.background = "transparent");

    netScaleEl.innerHTML = netScaleEl.textContent;
    netLinearEl.innerHTML = netLinearEl.textContent;
    netRyczEl.innerHTML = netRyczEl.textContent;

    const bestKey = Object.entries(nets).sort((a,b) => b[1]-a[1])[0][0];
    const badge = ' <span class="best-badge">najlepsza</span>';

    if(bestKey === "scale"){
      lineScale.style.background = "#f3f8ff";
      netScaleEl.innerHTML = netScaleEl.textContent + badge;
    } else if(bestKey === "linear"){
      lineLinear.style.background = "#f3f8ff";
      netLinearEl.innerHTML = netLinearEl.textContent + badge;
    } else {
      lineRycz.style.background = "#f3f8ff";
      netRyczEl.innerHTML = netRyczEl.textContent + badge;
    }
  }

  /* ====== CALC 1:1 wg wklejonego algorytmu inFakt (rocznie /12) ====== */
  function calculate(){
    const revenueM = n(incomeAmount.value);
    const costsM   = n(costAmount.value);
    const ratePct  = n(ryczRateDisplay?.value);
    const rate     = Math.max(0, ratePct) / 100;

    const { zusM, zusLumpM } = getZusMonthlyAndLumpMonthly();

    // ROCZNIE
    const revenueY = revenueM * 12;
    const costsY   = costsM * 12;
    const zusY     = zusM * 12;
    const zusLumpY = zusLumpM * 12;

    // i9_1_income_minus_costs
    const incomeMinusCostsY = revenueY - costsY;

    // i9_tax_base (bez ulg)
    const taxBaseY = incomeMinusCostsY - zusY;

    // =========================
    // SKALA: i25 + i21 + i15
    // =========================
    const salaryMinY = (Number(C.salary_min) || 0) * 12;
    const minHealthScaleY = (Number(C.health_contribution_general) || 0) * 12;

    // i25_type_general_contributions_s_z
    const healthScaleY = (taxBaseY < 0.75 * salaryMinY)
      ? minHealthScaleY
      : 0.09 * taxBaseY;

    const contributionsScaleY = zusY + healthScaleY;

    // i21_type_general_tax (singiel, bez małżonka, bez dzieci)
    const thresholdY = 120000;
    const freeY = 30000;

    let pitScaleY = 0;
    if (taxBaseY <= freeY) {
      pitScaleY = 0;
    } else if (taxBaseY <= thresholdY) {
      pitScaleY = 0.12 * (taxBaseY - freeY);
    } else {
      pitScaleY = 10800 + 0.32 * (taxBaseY - thresholdY);
    }
    pitScaleY = Math.max(0, pitScaleY);

    // i15_type_general_revenue
    const netScaleY = incomeMinusCostsY - pitScaleY - contributionsScaleY;
    const netScaleM = round2(netScaleY / 12);

    // =========================
    // LINIOWY: i26 + i22 + i16
    // =========================
    const minLinearThresholdY = 12 * (Number(C.health_contribution_min_linear) || 0);
    const minHealthLinearY    = 12 * (Number(C.health_contribution_linear) || 0);

    // i26_type_flat_contributions_s_z
    const healthLinearY = (taxBaseY < minLinearThresholdY)
      ? minHealthLinearY
      : 0.049 * taxBaseY;

    const contributionsLinearY = zusY + healthLinearY;

    // i22_type_flat_tax (odliczenie zdrowotnej limitowane)
    const limitHealthDeductY = Number(C.limit_health_contribution) || 0;
    const healthDeductY = Math.min(healthLinearY, limitHealthDeductY);

    const pitLinearY = 0.19 * Math.max(0, (taxBaseY - healthDeductY));

    // i16_type_flat_revenue
    const netLinearY = incomeMinusCostsY - pitLinearY - contributionsLinearY;
    const netLinearM = round2(netLinearY / 12);

    // =========================
    // RYCZAŁT: i27_2 + i23 + i17
    // =========================

    // i27_2_zus_lumpsum – próg liczony od (revenueY - zusLumpY)
    const baseForThreshold = revenueY - zusLumpY;

    let healthRyczY = 0;
    if (baseForThreshold <= 60000) {
      healthRyczY = 12 * (Number(C.health_contribution_lumpsum_60) || 0);
    } else if (baseForThreshold < 300001) {
      healthRyczY = 12 * (Number(C.health_contribution_lumpsum_300) || 0);
    } else {
      healthRyczY = 12 * (Number(C.health_contribution_lumpsum_over_300) || 0);
    }

    // i27_type_lumpsum_contributions_s_z
    const contributionsRyczY = zusY + healthRyczY;

    // i23_type_lumpsum_tax: podstawa = revenueY - (healthRyczY/2) - zusLumpY
    const pitRyczY = Math.max(0, (revenueY - (healthRyczY / 2) - zusLumpY) * rate);

    // i17_type_lumpsum_revenue
    const netRyczY = incomeMinusCostsY - pitRyczY - contributionsRyczY;
    const netRyczM = round2(netRyczY / 12);

    // render
    netScaleEl.textContent  = fmtPLN(netScaleM);
    netLinearEl.textContent = fmtPLN(netLinearM);
    netRyczEl.textContent   = fmtPLN(netRyczM);

    setBestHighlight({ scale: netScaleM, linear: netLinearM, rycz: netRyczM });
  }

  // Sync sliders
  function syncIncomeFromInput(){
    if (incomeRange && incomeAmount) {
      let v = n(incomeAmount.value);
      if (v < 0) v = 0;
      incomeAmount.value = String(v);
      incomeRange.value = String(Math.min(100000, Math.max(100, v)));
    }
    calculate();
  }
  function syncIncomeFromRange(){
    if (incomeRange && incomeAmount) incomeAmount.value = String(n(incomeRange.value));
    calculate();
  }

  function syncCostFromInput(){
    if (costRange && costAmount) {
      let v = n(costAmount.value);
      if (v < 0) v = 0;
      costAmount.value = String(v);
      costRange.value = String(Math.min(20000, Math.max(0, v)));
    }
    calculate();
  }
  function syncCostFromRange(){
    if (costRange && costAmount) costAmount.value = String(n(costRange.value));
    calculate();
  }

  function syncRyczFromIndex(){
    if (ryczRateIndex && ryczRateDisplay) {
      const idx = Math.round(n(ryczRateIndex.value));
      const rr = RYCZ_RATES[Math.min(RYCZ_RATES.length-1, Math.max(0, idx))];
      ryczRateDisplay.value = String(rr);
    }
    calculate();
  }
  function syncRyczFromInput(){
    if (ryczRateIndex && ryczRateDisplay) {
      const v = n(ryczRateDisplay.value);
      let bestIdx = 0;
      let bestDiff = Infinity;
      RYCZ_RATES.forEach((r,i) => {
        const d = Math.abs(r - v);
        if (d < bestDiff) { bestDiff = d; bestIdx = i; }
      });
      ryczRateIndex.value = String(bestIdx);
      ryczRateDisplay.value = String(RYCZ_RATES[bestIdx]);
    }
    calculate();
  }

  if (incomeAmount) incomeAmount.addEventListener("input", syncIncomeFromInput);
  if (incomeRange) incomeRange.addEventListener("input", syncIncomeFromRange);

  if (costAmount) costAmount.addEventListener("input", syncCostFromInput);
  if (costRange) costRange.addEventListener("input", syncCostFromRange);

  if (ryczRateIndex) ryczRateIndex.addEventListener("input", syncRyczFromIndex);
  if (ryczRateDisplay) ryczRateDisplay.addEventListener("change", syncRyczFromInput);

  document.querySelectorAll('input[name="zusOption"]').forEach(r => r.addEventListener("change", calculate));

  // init
  syncRyczFromIndex();
  calculate();
});
</script>

</body>
</html>
